# 05: ストリーム処理と整形

- 目的: stdout/stderr を行単位で扱い、色付け/JSON パースなどで可読性を向上する。
- 成果物: 行バッファ、ハイライト、エラーパターン検出、スピナー/進捗表示。

作業項目
- `readline` の `createInterface` で行単位ストリーム化。
- ANSI エスケープシーケンスの処理:
  - `strip-ansi` ライブラリでクリーンアップ（必要に応じて）
  - 色情報の保持または再適用（`chalk` 使用）
- JSON らしき出力の処理:
  - `JSON.parse()` でパース、`JSON.stringify()` で整形（indent: 2）
  - 失敗時は生文字列として表示
- エラーパターン検出:
  - 正規表現: `/\b(error|failed|exception|warning)\b/i`
  - 色付け: エラーは赤、警告は黄色
- 長時間処理時にスピナー/進捗を表示:
  - `ink-spinner` コンポーネントの使用
  - プロセス終了時に自動停止
- ユニットテスト: 各種ログを入力して整形結果を検証。

受け入れ条件
- 正常/エラー/JSON で表情が変わる（色/整形）。
- パフォーマンス劣化なく大きめログでも追従できる。
