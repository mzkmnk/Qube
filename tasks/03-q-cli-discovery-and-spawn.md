# 03: Q CLI 検出とプロセス起動

- 目的: Amazon Q CLI バイナリを検出し、子プロセスとして安全に起動する。
- 成果物: `Q_BIN` 環境変数/設定値の解決、`spawnQ()` ユーティリティ、エラーハンドリング。

作業項目
- 検出順序: `process.env.Q_BIN` → PATH 上の `amazonq`/`q`（名称は設定で拡張可能）。
- `which` コマンドまたは `command -v` でバイナリの存在確認。
- `child_process.spawn` で起動。stdout/stderr をストリームで受け取り、イベント/Promise を提供。
- タイムアウト/非ゼロ終了コード時の明確なエラーを実装。
  - 例: `エラー: Amazon Q CLI が見つかりません。Q_BIN 環境変数を設定するか、amazonq をインストールしてください。`
  - 例: `エラー: コマンドがタイムアウトしました (30秒)`
- ユニットテスト: `vi.spyOn(child_process, 'spawn')` でモックして成功/失敗/タイムアウトを検証。

受け入れ条件
- 存在しないバイナリ時に分かりやすいメッセージを出す。
- 簡易コマンド実行で標準出力が UI に反映される（テストで確認）。
